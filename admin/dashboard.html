<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin — Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="../css/styles.css"/>
</head>
<body>
  <nav class="navbar navbar-light bg-white shadow-sm">
    <div class="container-xl d-flex justify-content-between align-items-center">
      <div class="brand">Admin • Shopyfy</div>
      <div>
        <a class="btn btn-outline-secondary btn-sm me-2" href="products.html">Products</a>
        <a class="btn btn-outline-secondary btn-sm me-2" href="add-product.html">Add</a>
        <a class="btn btn-outline-secondary btn-sm me-2" href="orders.html">Orders</a>
        <a class="btn btn-outline-secondary btn-sm me-2" href="reports.html">Reports</a>
        <button id="admin-logout" class="btn btn-outline-danger btn-sm">Logout</button>
      </div>
    </div>
  </nav>

  <main class="container-xl py-4">
    <h4>Welcome, Admin</h4>
    <p class="text-muted">Use the links above to manage products and orders.</p>

    <div class="row">
      <div class="col-md-8">
        <div id="dashboard-widgets" class="row g-3">
          <div class="col-md-6">
            <div class="card p-3">
              <h6>Total products</h6>
              <div id="dash-total-products" class="h4">—</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-3">
              <h6>Total sold</h6>
              <div id="dash-total-sold" class="h4">—</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-3">
              <h6>Total stock</h6>
              <div id="dash-total-stock" class="h4">—</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-3">
              <h6>Recent orders</h6>
              <div id="dash-recent-orders" class="small text-muted">—</div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div id="admin-summary" class="card p-3"></div>
      </div>
    </div>

  </main>

<script src="../js/script.js"></script>
<script>
  if(!requireAdmin()) {} else {
    renderAdminSummary();
    const prods = loadProducts();
    const totalProducts = prods.length;
    const totalSold = prods.reduce((s,p)=>s+(p.sold||0),0);
    const totalStock = prods.reduce((s,p)=>s+(p.stock||0),0);
    document.getElementById('dash-total-products').textContent = totalProducts;
    document.getElementById('dash-total-sold').textContent = totalSold;
    document.getElementById('dash-total-stock').textContent = totalStock;
    const orders = getOrders();
    document.getElementById('dash-recent-orders').textContent = orders.length ? orders.slice(0,3).map(o=>o.id).join(', ') : 'No orders yet';
    document.getElementById('admin-logout').onclick = adminLogout;
  }
</script>
</body>
</html>
